name: win_step_summary

on: workflow_dispatch

jobs:
  job1:
    runs-on: windows-latest
    steps:
    - run: Add-Content -Path $env:GITHUB_STEP_SUMMARY -Value "# Job 1"
    - run: Add-Content -Path $env:GITHUB_STEP_SUMMARY -Value "- Step 1"
    - run: Add-Content -Path $env:GITHUB_STEP_SUMMARY -Value "- Step 2"
    - run: Add-Content -Path $env:GITHUB_STEP_SUMMARY -Value "- Step 3"

  job2:
      runs-on: windows-latest
      steps:
      - run: Add-Content -Path $env:GITHUB_STEP_SUMMARY -Value "# Job 2"
      - run: Add-Content -Path $env:GITHUB_STEP_SUMMARY -Value "- Step 1"
      - run: Add-Content -Path $env:GITHUB_STEP_SUMMARY -Value "- Step 2"
      - run: Add-Content -Path $env:GITHUB_STEP_SUMMARY -Value "- Step 3"
      - run: |
          # $summary = Get-Content -Path $env:GITHUB_STEP_SUMMARY -Encoding utf8
          # "$summary`n- Step 4 (overwritten)" > $env:GITHUB_STEP_SUMMARY
          "- Step 4 (overwritten)" > $env:GITHUB_STEP_SUMMARY

  job3:
    runs-on: windows-latest
    steps:
    - run: '"# Job 1"  | Out-File -FilePath $env:GITHUB_STEP_SUMMARY -Append'
    - run: '"- Step 1" | Out-File -FilePath $env:GITHUB_STEP_SUMMARY -Append'
    - run: '"- Step 2" | Out-File -FilePath $env:GITHUB_STEP_SUMMARY -Append'
    - run: '"- Step 3" | Out-File -FilePath $env:GITHUB_STEP_SUMMARY -Append'
    - run: Get-Content -Path $env:GITHUB_STEP_SUMMARY
